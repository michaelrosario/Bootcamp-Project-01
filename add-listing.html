<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <title>Add Listing - Work Rimot</title>
    <meta name="description" content="Add your business to Rimot and get people working in your establishment" />
    <meta name="keywords" content="work, spaces, free, cafe, coffee, wifi, manhattan, new york, remote" />

    <meta property="og:title" content="Add a Listing - Work Rimot" />
    <meta property="og:type" content="website"/>
    <meta property="og:description" content="Learn more about Rimot and the team." />
    <meta property="og:url" content="https://workrimot.com/add-listing.html" />

    <!-- Relinked Boostrap CSS CDN-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,500,700,900" rel="stylesheet">
    <!-- Simple line Icon -->
    <link rel="stylesheet" href="assets/css/simple-line-icons.css">
    <!-- Themify Icon -->
    <link rel="stylesheet" href="assets/css/themify-icons.css">
    <!-- Hover Effects -->
    <link rel="stylesheet" href="assets/css/set1.css">
    <!-- Main CSS -->
    <link rel="stylesheet" href="assets/css/style.css">

    <style>

        .error-message { 
            padding: 20px 20px 8px 20px; 
            border: #ff0000 solid 1px;
            border-radius: 6px;
            margin: 0 0 20px 0;
            color: red;
        }

        #add-listing label { display: none;  }
        #add-listing input { margin: 0 0 19px 0; height: 45px; }
        #add-listing h4 { margin: 0 0 20px 0; }
        #add-listing h6 { margin: 0 0 20px 0; }

        #business-type,
        #amenities { border: 1px solid #CCC; 
            width: 99%;
            margin: 0 auto 20px;
            padding: 20px 0 20px 0;
            border-radius: 5px;
        }

        #business-type label,
        #amenities label {
            position: relative;
            display: inline-block;
            width: auto;
            margin: 0;
            padding: 0 30px 0 25px;
            
        }
        #business-type input,
        #amenities input {
            position: absolute;
            float: left;
            left: 0px;
            top: -11px;
            padding: 10px;
        } 
        /* Style for the invalid fields */
        input:invalid{
          border-color: #900;
          background-color: #FDD;
        }

        input:focus:invalid {
          outline: none;
        }

        /* Style of our error messages */
        .error {
          width  : 100%;
          padding: 0;

          font-size: 80%;
          color: blue;
          background-color: #900;
          border-radius: 0 0 5px 5px;

          -moz-box-sizing: border-box;
          box-sizing: border-box;
        }

        .error.active {
          padding: 0.3em;
        }
    </style>

</head>

<body id="add-listing">
    <div class="nav-menu">
        <div class="bg transition">
            <div class="container-fluid fixed">
                <div class="row">
                    <div class="col-md-12">
                        <nav class="navbar navbar-expand-md navbar-light">
                            <a class="navbar-brand" href="/">
                                <img src="assets/images/rimote-logo.svg" alt="rimote-logo" id="rimotLogo" href="index.html">
                            </a>
                            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                                <span class="line1"></span>
                                <span class="line2"></span>
                                <span class="line3"></span>
                            </button>
                            <div class="collapse navbar-collapse justify-content-end" id="navbarNavDropdown">
                                <ul class="navbar-nav">
                                    <li class="nav-item dropdown">
                                        <a class="nav-link" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            Explore
                                            <span class="icon-arrow-down"></span>
                                        </a>
                                        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                                            <a class="dropdown-item" href="search/index.html?lat=40.80895639999999&lang=-73.96243270000002">Morningside Heights</a>
                                            <a class="dropdown-item" href="search/index.html?lat=40.81155039999999&lang=-73.9464769">Harlem</a>
                                            <a class="dropdown-item" href="search/index.html?lat=40.7957399&lang=-73.9389213">East Harlem</a>
                                            <a class="dropdown-item" href="search/index.html?lat=40.7870106&lang=-73.97536760000003">Upper West Side</a>
                                            <a class="dropdown-item" href="search/index.html?lat=40.77356489999999&lang=-73.9565551">Upper East Side</a>
                                            <a class="dropdown-item" href="search/index.html?lat=40.7637581&lang=-73.99181809999999">Midtown West & East</a>
                                            <a class="dropdown-item" href="search/index.html?lat=40.7465004&lang=-74.00137370000004">Chelsea</a>
                                            <a class="dropdown-item" href="search/index.html?lat=40.7478792&lang=-73.9756567">Murray Hill</a>
                                            <a class="dropdown-item" href="search/index.html?lat=40.7367783&lang=-73.98447220000003">Gramercy</a>
                                            <a class="dropdown-item" href="search/index.html?lat=40.7264773&lang=-73.9815337">East Village</a>
                                            <a class="dropdown-item" href="search/index.html?lat=40.7335719&lang=-74.00274179999997">Greenwich Village</a>
                                            <a class="dropdown-item" href="search/index.html?lat=40.72330099999999&lang=-74.00298829999997">Soho</a>
                                            <a class="dropdown-item" href="search/index.html?lat=40.715033&lang=-73.98427240000001">Lower East Side</a>
                                        </div>
                                    </li>
                                    <!--
                                    <li class="nav-item dropdown">
                                        <a class="nav-link" href="#" id="navbarDropdownMenuLink1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            Listing
                                        <span class="icon-arrow-down"></span>
                                        </a>
                                        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                                            <a class="dropdown-item" href="#">Action</a>
                                            <a class="dropdown-item" href="#">Another action</a>
                                            <a class="dropdown-item" href="#">Something else here</a>
                                        </div>
                                    </li>
                                    -->
                                    <li class="nav-item active">
                                        <a class="nav-link" href="./about.html">About Us</a>
                                    </li>
                                    <!--
                                    <li class="nav-item">
                                        <a class="nav-link" href="./blog.html">Blog</a>
                                    </li>
                                    -->
                                    <li><a href="./add-listing.html" class="btn btn-outline-light top-btn"><span class="ti-plus"></span> Add Listing</a></li>
                                </ul>
                            </div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- SLIDER -->
    <section id="parallax-header" class="masthead">
       <div class="container">
           <div class="columns col-md-12">
                <h1 class="text-center">Add Listing</h1>  <!--okay-->          
            </div>
       </div>
    </section>
    <script>
        document.getElementById("parallax-header").setAttribute('style',"opacity: 1; background: #fff url(assets/images/slider.jpg) no-repeat; background-size: cover; backgroundPositionY:"+(document.body.scrollTop)*0.5 );
    </script>
    <!--// SLIDER -->
    <!--//END HEADER -->
    <!--============================= FEATURED PLACES =============================-->
    <section class="main-block light-bg">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-12">
                        <h4>Add Your Business</h4>

                        <div class="success thanks-message" style="display: none;">
                            <p>Thank you for filling up the form and updating your listing.</p>
                        </div>

                        <div class="error-message" style="display: none;">
                            <p>Please fill out required fields.</p>
                        </div>

                        <form id="add-a-listing">
                            <div class="form-row">
                                <div class="col-md-12">
                                    <label for="businessName">Find Your Business</label>
                                    <input type="text" class="form-control" id="search" placeholder="Search For Your Business" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="col-md-12">
                                        <label for="businessName">Address</label>
                                        <input type="text" class="form-control" id="address" placeholder="Business Name" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-4">
                                    <label for="firstName">First Name</label>
                                    <input type="text" class="form-control" id="firstName" placeholder="First name" required>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for="lastName">Last Name</label>
                                    <input type="text" class="form-control" id="lastName" placeholder="Last name" required>
                                    
                                </div>
                                <div class="form-group col-md-4">
                                    <label for="mail">Email address</label>
                                    <input type="email" class="form-control" id="mail" placeholder="Enter email" required>
                                    
                                </div>
                            </div>
                            
                       
                                
                            <div id="business-type" class="form-group row">
                                <div class="col-sm-12">
                                   <h6>Business Type </h6>  
                                    <label class="form-check-label" for="form-coffee">
                                        <input name="type" value="Coffee Shop" class="form-check-input" type="checkbox" id="form-coffee">
                                        Coffee Shop 
                                    </label>
                                                                    
                                    <label class="form-check-label" for="form-restaurant">
                                            <input name="type" value="Restaurant" class="form-check-input" type="checkbox" id="form-restaurant">
                                            Restaurant
                                    </label>
                                                                
                                    <label class="form-check-label" for="form-bar">
                                            <input name="type" value="Bar" class="form-check-input" type="checkbox" id="form-bar">
                                            Bar
                                    </label>
                                                            
                                    <label class="form-check-label" for="form-coworking">
                                            <input name="type" value="Coworking Space" class="form-check-input" type="checkbox" id="form-coworking">
                                            Coworking Space
                                    </label>
                                    <div id="checkbox1"></div>       

                                </div>
                            </div>
                            <div id="amenities" class="form-group row">
                                <div class="col-sm-12">
                                    <h6>Available Amenities</h6>
                                
                                    <label class="form-check-label" for="form-wifi">
                                        <input name="amenities" value="Free Wi-Fi" class="form-check-input" type="checkbox" id="form-wifi">
                                        Free Wi-Fi 
                                    </label>
                                
                                    <label class="form-check-label" for="form-power">
                                        <input name="amenities" value="Power Outlets" class="form-check-input" type="checkbox" id="form-power">
                                        Power Outlets
                                    </label>
                                    
                                    <label class="form-check-label" for="form-restroom">
                                        <input name="amenities" value="Restrooms" class="form-check-input" type="checkbox" id="form-restroom">
                                        Restrooms
                                    </label>
                                    
                                    <label class="form-check-label" for="form-food">
                                        <input name="amenities" value="Food/Drink" class="form-check-input" type="checkbox" id="form-food">
                                        Food/Drink
                                    </label>
                                    <div id="checkbox2"></div>       

                                </div>
                            </div>
                        
                            <div class="row">
                                <div class="col-sm-12 text-center">
                                    <input id="placeId" name="placeId" value="" type="hidden">
                                    <button type="submit" class="submit-button btn btn-primary">Submit</button>
                                </div>
                            </div>
                        </form>
                </div>
            </div>
        </div>
    </section>

   
    <!--//END CATEGORIES -->
    <!--============================= ADD LISTING =============================-->

    <!--//END ADD LISTING -->
    <!--============================= FOOTER =============================-->
    <footer class="main-block dark-bg">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <div class="copyright">
                            <p>Copyright 2019&copy;</p>
                            <ul>
                                <li><a href="#"><span class="ti-facebook"></span></a></li>
                                <li><a href="#"><span class="ti-twitter-alt"></span></a></li>
                                <li><a href="#"><span class="ti-instagram"></span></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!--//END FOOTER -->
    
    <!--//Needed to reorganize my script links for the dropdown menu to work-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.8.5/firebase.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDgBO7u3km3m85oAstb-On7w7m5k78g_hY&libraries=places"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="../assets/js/global.js"></script>
  
    <script>

        $("#add-a-listing").on("submit",function(e){
            e.preventDefault();

            return false;

        });


        var options = {
            keyword:'cafe',
            types: ['establishment']
        }

        var input = document.getElementById("search");
        var autocomplete = new google.maps.places.Autocomplete(input,options);

        autocomplete.addListener('place_changed', function () {
            var place = autocomplete.getPlace();
            if (!place.geometry) {
                window.alert("No details available for input: '" + place.name + "'");
                return;
            } else {
                console.log(place);
                $("#address").val(place.formatted_address);
                $("#placeId").val(place.id); 
            }
        });

        // FIREBASE CONFIG
        var config = {
        apiKey: "AIzaSyDbUywd58phZolNaXoEYSvAskt2gw0QGLE",
        authDomain: "rimot-41ba4.firebaseapp.com",
        databaseURL: "https://rimot-41ba4.firebaseio.com",
        projectId: "rimot-41ba4",
        storageBucket: "",
        messagingSenderId: "219006616621"
        };

        firebase.initializeApp(config);

        var database = firebase.database();
        var checkins = database.ref("/check-ins");

        $("input").on("focus",function(){
            $(".error-message").hide();

        });
    

        $(".submit-button").on("click",function(e){
    
            e.preventDefault();
            var id = $("#placeId").val();

            if(id){
                var businessType = [];
                var amenities = [];
                var firstName =  $("#firstName").val() || "";
                var lastName = $("#lastName").val() || "";
                var error = document.querySelector(".error");
                var emailForm = document.getElementById("mail");
                var email = $("#mail").val() || "";
                if(!email){
                    console.log("email check")
                    emailForm.addEventListener("submit", function (event) {
                      if (email.validity.typeMismatch) {
                        emailForm.setCustomValidity("I expect an e-mail, darling!");
                      } else {
                        email = $("#mail").val();
                      }
                    });

                }
                
                $('input[type="checkbox"][name="type"]').on('change',function(){
                  var getArrVal = $('input[type="checkbox"][name="type"]:checked').map(function(){
                    return this.value;
                    console.log("checkebox1: " + this.value);
                  }).toArray();

                  if(getArrVal.length){
                    //execute the code
                    $('#check1').html(getArrVal.toString());

                  } else {
                    $(this).prop("checked",true);
                    $('#check1').html("At least one value must be checked!");
                    return false;

                  };
                });
                
                $("input[name=type]:checked").each(function(){
                    businessType.push($(this).val());
                    console.log($(this).val());
                });

                $("input[name=amenities]:checked").each(function(){
                    amenities.push($(this).val());
                    console.log($(this).val());
                });

                var listingData = {
                    firstName,
                    lastName,
                    email,
                    amenities,
                    businessType
                }

            }

            console.log('listingData',listingData);

            if(id && firstName && lastName && email && amenities.length > 0 && businessType.length > 0){
                    database.ref("/check-ins/"+id).update(listingData);
                    $(".thanks-message").fadeIn();
                    $("#add-a-listing").hide();
            } else {
                $(".error-message").fadeIn();
            }
        });

    </script>

    
</body>

</html>